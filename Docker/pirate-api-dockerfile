FROM python:3.14-slim

ENV PYTHONDONTWRITEBYTECODE=1 \
    PYTHONUNBUFFERED=1 \
    PYTHONPATH=/app

RUN apt update && \
    apt -y install build-essential \
                    libffi-dev \
                    unzip \
                    rsync \
					git
                            
# Set the working directory inside the container
WORKDIR /app

# Install deps first for better build caching
COPY Docker/requirements-api.txt /app/
RUN pip install --no-cache-dir -r /app/requirements-api.txt

# Copy the run scripts from the API directory (relative to the build context)
COPY API /app/API

ENTRYPOINT ["uvicorn"]

# Set the default command
CMD ["API.responseLocal:app", "--host", "0.0.0.0"]
